# Плагин Project Progress для Redmine

## Описание
Плагин Project Progress предоставляет возможность отображения общего прогресса выполнения проекта в Redmine. Плагин поддерживает различные методы расчета прогресса, гибкие настройки фильтрации задач и интеграцию в интерфейс Redmine.

## Установка
1. Скопируйте папку плагина в директорию `plugins/` вашего Redmine
2. Перезапустите Redmine
3. Перейдите в раздел "Администрирование" → "Плагины" → "Project Progress Plugin" → "Настройки"

## Настройки плагина

### 1. Методы расчета прогресса

#### **Метод расчета по умолчанию** (`default_calculation_method`)
Выберите основной метод расчета прогресса проекта:

- **`progress_by_status`** - Расчет по статусам задач (по умолчанию)
- **`weighted_progress`** - Взвешенный расчет по приоритетам
- **`average_progress`** - Средний прогресс по выполнению
- **`parent_project_aggregation`** - Агрегация дочерних проектов

#### **Взвешенный расчет по приоритетам** (`weighted_progress`)
Настройки весов для разных приоритетов:
- **Высокий приоритет** (`priority_weights_high`) - по умолчанию 3.0
- **Обычный приоритет** (`priority_weights_normal`) - по умолчанию 2.0  
- **Низкий приоритет** (`priority_weights_low`) - по умолчанию 1.0

#### **Паттерны для Story Points** (`story_points_patterns`)
Список названий полей для поиска Story Points (через запятую):
- По умолчанию: `story point,complexity,size,estimate`

### 2. Настройки фильтрации задач

#### **Включать подзадачи** (`include_subtasks`)
- **Включено** - учитывать подзадачи в расчете прогресса
- **Выключено** - учитывать только основные задачи (по умолчанию)

#### **Включать закрытые задачи** (`include_closed_issues`)
- **Включено** - учитывать закрытые задачи в общем количестве (по умолчанию)
- **Выключено** - не учитывать закрытые задачи

#### **Считать 100% как завершенные** (`count_100_percent_as_closed`)
- **Включено** - задачи с 100% выполнения считаются завершенными (по умолчанию)
- **Выключено** - только задачи со статусом "Закрыт" считаются завершенными

#### **Минимальное количество задач** (`minimum_issues_count`)
Минимальное количество задач для отображения прогресса:
- По умолчанию: 1
- Если задач меньше указанного числа, прогресс не отображается

#### **Исключить трекеры** (`exclude_trackers`)
Список трекеров для исключения из расчета (через запятую):
- Пример: `Bug,Support`
- Пустое поле - учитывать все трекеры

#### **Исключить приоритеты** (`exclude_priorities`)
Список приоритетов для исключения из расчета (через запятую):
- Пример: `Low,Trivial`
- Пустое поле - учитывать все приоритеты

### 3. Настройки для родительских проектов

#### **Включать собственные задачи** (`parent_project_include_own_issues`)
- **Включено** - учитывать задачи самого родительского проекта (по умолчанию)
- **Выключено** - учитывать только задачи дочерних проектов

#### **Взвешивать дочерние проекты** (`parent_project_weight_children`)
- **Включено** - применять веса к дочерним проектам (по умолчанию)
- **Выключено** - равномерное распределение весов

#### **Метод расчета прогресса** (`parent_project_calculation_method`)
Выберите метод расчета прогресса для родительских проектов:

- **`weighted_average`** - По количеству задач (взвешенное среднее) (по умолчанию)
  - Проекты с большим количеством задач имеют больший вес
  - Пример: если в проекте A 10 задач (50% прогресс), а в проекте B 2 задачи (100% прогресс), то общий прогресс = (50×10 + 100×2) / 12 = 58.3%

- **`simple_average`** - Простое среднее
  - Все проекты имеют равный вес независимо от количества задач
  - Пример: если в проекте A 10 задач (50% прогресс), а в проекте B 2 задачи (100% прогресс), то общий прогресс = (50 + 100) / 2 = 75%

### 4. Настройки отображения

#### **Показывать в сайдбаре проекта** (`show_in_sidebar`)
- **Включено** - отображать прогресс в боковой панели проекта
- **Выключено** - не отображать в сайдбаре (по умолчанию)

#### **Переключатель прогресса на странице проектов**
На странице проектов автоматически добавляется переключатель для показа/скрытия прогресса:
- **По умолчанию включен** - прогресс показывается для всех проектов
- **Состояние сохраняется** в браузере пользователя
- **Работает для всех представлений** - таблица, панель, карточки

#### **Экспорт проектов с прогрессом**
Добавлена возможность экспорта всех проектов в CSV файл с информацией о прогрессе:
- **Кнопка экспорта** - в конце страницы проектов
- **Дополнительные столбцы** - Progress (%), Closed Issues, Total Issues
- **Автоматическое именование** файла с датой
- **Права доступа** - только авторизованные пользователи

### 5. Настройки производительности

#### **Кэширование расчетов** (`cache_calculation`)
- **Включено** - кэшировать результаты расчета для повышения производительности
- **Выключено** - всегда рассчитывать заново (по умолчанию)

#### **Длительность кэша** (`cache_duration`)
Время хранения кэша в секундах:
- По умолчанию: 600 секунд (10 минут)
- Минимум: 60 секунд
- Максимум: 3600 секунд (1 час)

### 6. Настройки отладки

#### **Включить отладочное логирование** (`enable_debug_logging`)
- **Включено** - записывать подробную информацию в лог
- **Выключено** - минимальное логирование (по умолчанию)

#### **Детальное логирование расчетов** (`log_calculation_details`)
- **Включено** - записывать детали каждого шага расчета
- **Выключено** - только основная информация (по умолчанию)

## Использование

### Отображение в сайдбаре
Если включена настройка "Показывать в сайдбаре проекта", прогресс будет автоматически отображаться в боковой панели каждого проекта.

### Страница прогресса
Перейдите в меню проекта → "Прогресс проекта" для просмотра детальной информации о прогрессе.

### Переключатель прогресса на странице проектов
На странице проектов (`/projects`) автоматически добавляется:
- **Переключатель** в верхней части страницы для показа/скрытия прогресса
- **Кнопка экспорта** в конце страницы для скачивания CSV файла с прогрессом
- **Поддержка всех представлений** - таблица, панель, карточки

### Экспорт проектов с прогрессом
1. Перейдите на страницу проектов (`/projects`)
2. Найдите блок "Экспорт проектов с прогрессом" в конце страницы
3. Нажмите кнопку "Скачать CSV с прогрессом"
4. Получите файл `projects_with_progress_YYYYMMDD.csv` с дополнительными столбцами:
   - **Progress (%)** - процент выполнения
   - **Closed Issues** - количество закрытых задач
   - **Total Issues** - общее количество задач

### API доступ
Плагин предоставляет API для получения данных о прогрессе:
```
GET /projects/:project_id/project_progress.json
```

## Права доступа
- **Просмотр прогресса** - доступно всем авторизованным пользователям
- **Настройки плагина** - только администраторам

## Поддержка
При возникновении проблем проверьте:
1. Настройки плагина в разделе "Администрирование"
2. Логи Redmine для отладочной информации
3. Права доступа пользователей к проектам

## Версия
Текущая версия: 1.0.0
